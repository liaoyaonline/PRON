# 系统设计
系统设计是在需求分析之后的阶段,其主要任务是建立系统的逻辑模型。主
要围绕功能模块设计、类图设计和数据库设计等方面展开。系统设计的成果将会
直接服务于系统的实施和代码编写过程。
## 系统架构与设计原则
### 系统架构
系统架构包括硬件体系架构和软件设计架构两个方面。硬件架构采用
客户端-应用服务器-数据库服务器模式。软件设计架构采用表示层、业务逻
辑层和数据访问层三层架构形式。系统软件架构如图 4-1 所示。
(1)表示层:即用户界面层,它是由各种边界类组成。表示层的作用是为
用户提供操作界面,通过它可以输入数据或者显示系统的输出数据。在具体设计
时,表示层主要由各种 HTML 标记组成的网页文件实现,但也会包含少量的用
于客户端验证的 JavaScript 脚本代码。
(2)业务逻辑层:主要由各种处理业务逻辑功能的类组成,用于负责处理
CRM 系统管理过程中涉及的各功能模块的应用逻辑。它接收来自表示层中页面
的请求,完成相关的业务逻辑处理。如果涉及到数据库操作,还需调用数据访问
层中的数据操作类。
(3)数据访问层:是系统与数据库之间的操作界面,主要用于解决对数据
库的具体的访问过程。数据访问层由各种数据操作类组成,往往会针对一张表定
义一个数据操作类,类中包含了对数据表中记录的增、删、改、查等功能的对应代码。
### 设计原则
(1)坚持一切以用户为中心的原则。系统开发结果的好坏,最终的评论权
在用户那里。如果开发的系统得不到用户的承认,那设计的系统就没有任何意义
可言;
(2)坚持以实用性为导向的原则。任何一个系统的开发都是为了解决被委
托单位的实际问题。对于本系统而言,其实用性主要体现在解决扬子公司对CRM
系统的实际应用需求,帮助扬子公司更好的开展对客户的服务;
(3)坚持以安全性为关键要素的原则。系统安全性体现在使用CRM系统的
过程中,系统需要验证用户是否是有效的合法用户。除了采用登录机制来验证用
户是否合法,还可以采取对重要敏感信息进行加密保存的措施;
(4)坚持以可扩展、可维护为重要指标的原则。为了便于对系统进行升级
和维护,系统在设计时就应该要具有可扩展性和易维护性。对于本系统来说,软
件设计采用的是基于B/S模式的三层架构设计理念,这可以满足可扩展性要求。
同时,系统业务逻辑在服务器端实现,只需要对服务器端进行维护就能达到维护
整个系统的目的。
## B/S设计模式
B/S 模式是目前开发基于 Web 的应用系统的主要模式。随着互联网时代
的到来,浏览器已经成为用户访问服务器资源的主要工具。而传统的 C/S
模式开发的系统,在客户端需要安装应用软件。这对软件的升级和维护会
带来一定的困难,尤其是客户端机器数量比较多且又分布在不同地理位置
的情况下。采用 B/S 模式开发的应用系统的业务逻辑功能主要在服务器端
实现,对系统功能的增删可以通过改变服务器中网页的数量就能完成,因
此,非常有利于对系统进行升级和维护。由于本系统用户在使用系统时的
地理位置不常固定,采用 B/S 模式开发才符合用户的使用实际。这也是本
系统为何采用 B/S 模式进行开发的原因。
## 系统功能模块设计
根据前面的需求分析结果,可以把系统功能概括为以下几个模块,系统模块
结构如图 4-2 所示:
### 登录与注销
在对登录功能进行设计时,系统需要设计一个登录界面,用于用户输入自己
的登录信息。用户输完登录信息后向系统进行提交登录请求。系统会对用户进行
身份验证,验证通过后该用户才能进入系统访问。在登录时还需要选择登录类型,
登录类型不同,用户进入的操作界面也不同。登录流程如图 4-3 所示。
### 小说管理
从模块的功能设计来看,客户管理主要是用于对客户基本资料的添加、修改
和删除等操作。添加新客户时,通过添加界面完成,最终把客户资料保存到后台
客户信息表中。同样,对客户的修改也是针对客户信息表进行,修改后也需要保
存客户的修改信息。删除客户信息时需要确认是否要真的删除,因为一旦删除后
客户的信息就不存在了,因此,可以给客户信息做个删除标志,先不进行物理删
除,这样就有机会来恢复该客户信息。客户管理流程如图 4-4 所示。
### 书架管理
走访管理模块主要是用于对客户走访信息的添加、修改和删除等操作。添加
新的走访信息时,通过添加界面完成,最终把对客户的走访信息保存到后台客户
走访信息表中。同样,对客户走访信息的修改也是针对走访信息表进行,修改后
也需要保存修改后的走访信息。删除客户走访信息时需要确认是否要真的删除,
因为一旦删除后客户走访信息就不存在了。因此,可以给客户走访信息做个删除
标志,先不进行物理删除,这样就有机会来恢复该客户走访信息。客户走访管理
流程如图 4-5 所示。
### 书单管理
反馈管理主要是用于对客户反馈信息的添加、修改和删除等操作。添加新的
客户反馈信息时,通过添加反馈信息界面完成,最终把客户反馈信息保存到后台
反馈信息表中。同样,对客户反馈信息的修改也是针对客户反馈信息表进行,修
改后也需要保存客户反馈信息的修改结果。删除客户反馈信息时需要确认是否要
真的删除,因为一旦删除后客户反馈信息就不存在了,因此,可以给客户反馈信
息做个删除标志,先不进行物理删除,这样就有机会来恢复该客户反馈信息。客
户反馈管理流程如图 4-6 所示。
### 个性化推荐
从模块的功能设计来看,客户服务管理主要是用于对客户服务信息的添加、
修改和删除等操作。添加新的客户服务信息时,通过添加客户服务界面完成,最
终把客户服务信息保存到后台客户服务信息表中。同样,对客户服务信息的修改
也是针对客户服务信息表进行,修改后也需要保存客户服务信息的修改结果。删
除客户服务信息时需要确认是否要真的删除,因为一旦删除后客户服务信息就不
存在了,因此,可以给客户服务信息做个删除标志,先不进行物理删除,这样就
有机会来恢复该客户服务信息。客户服务管理流程如图 4-7 所示
## 设计类图
边界类、实体类和控制类是一种类的划分方法。边界类对应用户界面;实体
类对应实体信息及其操作;控制类对应于系统业务逻辑的管理,在三层架构模型
中,边界类对应表示层中的类,控制类对应于业务逻辑层中的类,而实体类对应
数据访问层中的类。
1、登录类图
在登录类图中,Login.aspx 文件是属于表示层中的边界类对象,登录管理类
LoginMange 是属于业务逻辑层的类,登录操作类 loginop 则是属于数据访问层的
类。用户登录类图,如图 4-13 所示。
说明如下:
(1)Login.aspx 对应于表示层中的登录界面;
(2)控制类 LoginManage 对应于业务逻辑层,类中方法 IsLogin()用于返回用户
登录成功与否的返回信息。IsLogin()方法中使用了 name,password 两个参数。
这两个参数由表示层中的边界类传递。
2、书架管理类图
客户管理类图如图 4-14 所示。
(1)边界类 Customm.aspx 对应于表示层,用于提供客户编辑的界面;
(2)控制类 Custommanage 对应于业务逻辑层;
(3)实体操作类 Customop 对应于数据访问层;
(4)实体信息类 Customer 的作用是作为参数在三层之间进行调用。
## 顺序图
### 登录顺序图
登录的过程就是一个从表示层中的登录界面开始的过程。用户向登录管理类
发出登录请求这个事件,登录管理对象则调用数据访问对象中的登录验证方法来
验证本次登录请求是否成功。数据访问类中的登录验证方法是根据核对用户名和
密码来完成。如果验证成功,则从数据访问对象向登录管理对象返回登录验证通
过的信息。登录管理对象同样把登录成功的信息向表示层界面返回。如果登录没
有成功,同样也会返回登录出错的信息,登录顺序图如图 4-15 所示。
### 添加书本顺序图
在添加客户信息时,首先向客户管理界面发出添加客户信息的请求,系统显
示添加客户信息界面,等待用户输入客户信息。属于控制类的客户管理模块对用
户提交的添加客户信息申请向属于客户操作类的客户操作对象传递。客户操作对
象调用数据库模块中的客户管理类中的添加方法向客户信息表中添加一条客户
记录,并返回添加后的当前状态给用户,添加客户顺序图如图 4-16 所示。
### 加入书架顺序图
在编辑客户信息时,首先向客户管理界面发出编辑客户信息的请求,系统显
示编辑客户信息界面,等待用户修改客户信息。属于控制类的客户管理模块对用
户提交的编辑客户信息申请向属于客户操作类的客户操作对象传递。客户操作对
象调用数据库模块中的客户管理类中的编辑方法对客户信息表中编辑一条客户
记录,并返回编辑后的当前状态给用户。编辑客户顺序图如图 4-17 所示。
### 删除书架顺序图
在删除客户信息时,首先向客户管理界面发出删除客户信息的请求,系统显
示所有客户信息列表,等待用户输入删除的客户信息。属于控制类的客户管理模
块对用户提交的删除客户信息申请向属于客户操作类的客户操作对象传递。客户
操作对象调用数据库模块中的客户管理类中的删除方法删除客户信息表中的一
条或多条符合条件的记录,并返回删除后的当前状态给用户。删除客户顺序图如
图 4-18 所示。
## 数据库设计
数据库在信息系统开发中的作用是无法替代的。与本地数据库相比,在采用
B/S 模式开发的系统中,使用的数据库被称为 Web 数据库。数据库设计的主要任
务是如何从现实世界中建立起数据库的概念模型,以及数据库中应该包含哪些
数据表。这就需要在数据库设计过程中及时发现存在于现实世界中的各种客
观实体。然后确定这些实体之间是否存在某种直接或间接的联系。一旦确定
实体后,就可以借助于 E-R 图来描述它们之间的关系。
### 概念设计
数据库的概念设计就是要建立 E-R 模型。概念设计的目的就是要找出系统
中可能存在的实体及其直接的关系,以便建立合适的数据表结构。本系统部分
E-R 图如图 4-19 所示。
### 数据库表设计
根据对数据库进行需求分析,可以得出系统中的主要数据表如下:
1、登录用户表(loginuser),用于保存登录用户信息。表结构如表 4-1 所示。
小说信息表(customer),用于保存小说的基本信息。表结构如表 4-2 所示
书架信息表(chanpin),用于保存书架的信息。表结构如表 4-3 所示。
书单信息表(chanpinlb),用于保存书单的信息。表结构如表 4-4
所示。
推荐小说表(yuangong),用于推荐小说的基本信息。表结构如表 4-5 所示。

## 本章小节
本章介绍了系统的设计过程。首先对系统架构和设计原则进行了介绍。接着
介绍了系统主要功能模块的设计过程。同时对类图和顺序图的设计过程进行了介
绍。最后对数据库进行了概念设计和逻辑设计,得到了数据库中的主要数据表结
构。
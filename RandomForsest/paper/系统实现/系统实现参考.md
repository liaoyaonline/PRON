# 系统实现
## 登录模块
1、登录界面
登录界面由两个文本框、一个下拉列表框和两个按钮构成。两个文本框一个
用于输入用户名,另一个用于输入密码。下拉列表框用于选择登录用户的角色,
本系统中有操作员和管理员两个角色。两个按钮一个用于提交登录信息,一个用
于取消登录。登录界面如图5-1所示。管理员登录成功后的界面如图5-2所示。普
通业务员进入的操作界面如图5-3所示。
2、业务逻辑实现
当 用 户输入登录信 息后 ,在客户端首先进行非空验证,具体由相应的
Javascript 客户端脚本代码实现。用户点击“确定”按钮,触发了该按钮的 Click
事件,从而由表示层对象调用业务逻辑层对象 LoginUserBLL 的验证登录信息
方法 IsLogin()函数的功能。同时也要判断当前登录用户角色是操作员还是管
理员。
关键代码分析
## 客户管理模块
### 添加客户
1、界面的实现
添加客户界面如图 5-4 所示。
2、业务逻辑实现
添加客户功能由客户管理类CustomerMageBLL中的添加方法addcustomer()完
成。在客户信息添加时,需要对那些标注为必填项的区域中一定要输入相关信息,
否则会提示出错。对必填项的判断可以通过客户端验证实现,这样可以减少服务
器端的验证处理时间,减轻服务器端的压力。填完后点击“提交”按钮向系统提
交新的客户信息。系统后台通过执行SQL语句中的INSERT语句就可以保存新的
客户信息。
3、关键代码
### 客户维护
1、界面实现
客户维护界面如图 5-5 所示。
2、业务逻辑实现
在查询时,只要输入查询的客户名称或联系人部分信息,系统可以实现模糊
查询功能。查询的结果会显示在一个 GridView 数据绑定控件中。在执行删除和
编辑操作时,首先获取当前行所在记录的 id,然后把它作为参数传递到相应的编
辑和删除语句中。在编辑时,系统会自动生成“更新”和“取消”链接,用户可
以根据自己的需要选择更新或者取消功能。
### 客户走访模块
客户走访管理主要和员工表和客户走访表有关。员工表和客户走访表之间通
过员工编号建立关联,这样可以获取到参与走访的员工姓名等信息。
1、界面实现
客户走访管理界面如图的 5-6 所示。
新增客户走访界面如图 5-7 所示。
2、业务逻辑实现
系统首先通过一个数据绑定控件 GridView 来展示所有的客户走访信息。为
了便于查找到所需要编辑或删除的走访信息,系统专门在界面中提供一个查询功
能。用户可以输入走访客户的名称来进行查找,条件为空时显示全部走访客户信
息。如果输入了完整的查询内容,则系统会进行精确查找,否则,如果只输入要
查找内容的部分信息,则系统会根据输入的走访客户名称中的部分信息进行模糊
查询,即部分匹配查询。不管是精确查询还是部分条件的模糊查询,其查询结果
也是在一个数据绑定控件中进行展示。然后用户可以根据要求对该走访客户信息
进行编辑或删除操作。当需要添加走访客户信息时,只需要点击界面中的“新增”
按钮就可以进入到添加走访客户信息界面。如果需要打印走访客户信息,则需要
点击“打印”按钮即可实现。
3、关键代码
以新增客户走访信息为例,其实现代码如下:
### 客户反馈模块
1、界面实现
客户反馈管理界面如图 5-8 所示。新增反馈界面如图 5-9 所示。
### 客户分析模块
#### 数据抽样
客户分析模块的主要功能是实现对客户的分类,而分类结果的准确率取决于
分类数据的数量和质量。在本系统中,针对于个人客户的分类数据,是将客户的
年龄分为“小于等于30”、“30到50之间”和“大于50”三个年龄段,分别代表
青年、中年和老年客户;将产品价格分为高、中、低三档,收入水平划分为<3000、
3000-6000和>6000三类;客户性别分为男和女。类别分为流失和未流失两类,具
体是根据对客户的历史销售数据按R、F、M处理后产生。判断规则是,RFM综
合评定数据大于平均值,就将其列为未流失,反之就列为流失。分类训练样本数
据集如表5-1所示。
#### 用 ID3 算法建立分类模型
m
使用 Info(D)=- ∑ p i log 2 ( p i ) 计算初始信息熵为:
i = 1
Info(s 1 ,s 2 )=Info(18,8)=0.8905
然后计算客户年龄、收入水平、产品档次和客户性别 4 个属性的熵。首先观
察年龄属性的每个样本值的“未流失”、“流失”的分布,分别计算每个分布的
信息熵:
###本章小结
本章完成了系统主要模块的功能实现,具体对界面实现、业务逻辑实现和关
键代码等方面进行了阐述。